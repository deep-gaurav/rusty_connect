fragment IdentityPayloadFields on IdentityPayloadBody {
  deviceId
  deviceName
  deviceType
  incomingCapabilities
  outgoingCapabilities
  tcpPort
  protocolVersion
}
fragment BatteryFields on BatteryPayload {
  thresholdEvent
  currentCharge
  isCharging
}

fragment DeviceFields on Device {
  id
  identity {
    ...IdentityPayloadFields
  }
  paired
  pluginConfigs {
    ping {
      enabled
    }
    clipboard {
      enabled
    }
  }
  pluginStates {
    batttery {
      lastStatus{
        ...BatteryFields
      }
    }
  }
}

fragment DeviceWithStateFields on DeviceWithState {
  device {
    ...DeviceFields
  }
  isConnected
}

fragment RecievedPayloadFields on ReceivedPayload {
  __typename
  ... on Connected {
    id
  }
  ... on Disconnected {
    id
  }
  ... on Payload {
    id
    type
    body
  }
  ... on IdentityPayloadBody {
    ...IdentityPayloadFields
  }
  ... on PairPayloadBody {
    pair
  }
  ... on ClipboardPayload {
    content
  }
  ... on PingPayload {
    pinged
  }
  ... on BatteryPayload {
    ...BatteryFields
  }
}

query AllDevices {
  devices {
    ...DeviceWithStateFields
  }
}

query Device($id: String!) {
  device(id: $id) {
    ...DeviceWithStateFields
  }
}

mutation Pair($id: String!, $pair: Boolean!) {
  pair(id: $id, pair: $pair) {
    ...DeviceWithStateFields
  }
}

mutation BroadcastUdp {
  broadcastIdentityUdp {
    ...IdentityPayloadFields
  }
}

mutation SendClipboard($content: String!, $deviceId: String) {
  plugins {
    clipboard {
      sendClipboard(deviceId: $deviceId, content: $content)
    }
  }
}

subscription ConnectionSubscription {
  payloads {
    deviceId
    payload {
      ...RecievedPayloadFields
    }
  }
}
